<!DOCTYPE html>
<html>
<head>
	<title>System Administrator Panel</title>
	<script src="js/jquery.min.js"></script>
	<script>

		$(document).ready(function(){
      var index = getIndexFromUrl();

      $.ajax({
        type: 'GET',
        url: 'app/airlines/getAirline?index=' + index,
        contentType: 'application/json',
        dataType: 'json',
        data: {},
        success: function(data) {
          showAirline(data);
          addEditAirlineFormEventListener(data);
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
          alert("AJAX ERROR: " + errorThrown);
        }
      });
    });

    function showAirline(airline) {
      var inputs = $("input");
      console.log(airline);
      for(var i = 0; i < inputs.length - 1; i++) {
        var input = inputs.eq(i);
        var inputName = input.attr("name");
        console.log(airline[inputName]);
        input.attr("value", airline[inputName]);
      }
    }

    function getIndexFromUrl() {
      var search = window.location.search.substring(1);
      var vars = search.split("&");
      var pair = vars[0].split("=");
      return pair[1];
    }

    function addEditAirlineFormEventListener(originalAirline) {
      $("#editAirLineButton").click(function(){
				var airline={};
				airline.airLineName = $("#airlineName").val();
				airline.airLineAddress = $("#airlineAddress").val();
				airline.airLineDescription = $("#airlineDesc").val();				
				
				var airlineObj = JSON.stringify(airline);
				$.ajax({
					method:"POST",
					url:'app/airlines/editAirline?id=' + originalAirline.airLineID,	
					data: airlineObj,
					contentType:"application/json; charset=utf-8",
					success:function(data){
						window.location.replace('http://localhost:8888');
					},
					error: function(error)
					{
						$(document.documentElement).html("<p>"+error+"</p>");
					}
				})
			})
    }
		
	</script>
</head>

<body>
		<h1>Edit Airline:</h1>

    <form>
      Airline name: <input type="text" name="airLineName" id="airlineName"><br><br>
      Airline address: <input type="text" name="airLineAddress" id="airlineAddress"><br><br>
      Airline description: <input type="text" name="airLineDescription" id="airlineDesc"><br><br>
      <input type="submit" id="editAirLineButton" value="Edit"><br><br>
    </form>
		
</body>
</html>